{"version":3,"sources":["app.js","index.js"],"names":["express","require","path","app","https","fs","options","key","readFileSync","cert","server","createServer","io","use","static","join","__dirname","get","req","res","sendFile","resolve","clientCount","console","log","on","socket","message","roomId","to","emit","module","exports","port","listen"],"mappings":"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","file":"index.js","sourceRoot":"../src","sourcesContent":["const express = require('express');\r\nconst path = require('path');\r\nconst app = express();\r\nconst https = require('https');\r\nconst fs = require('fs');\r\n\r\nconst options = {\r\n    key: fs.readFileSync('key.pem'),\r\n    cert: fs.readFileSync('cert.pem')\r\n};\r\n\r\nconst server = https.createServer(options, app);\r\n\r\nconst io = require('socket.io')(server);\r\n\r\napp.use(express.static(path.join(__dirname, 'public')));\r\n\r\napp.get('/', (req,res)=>{\r\n    res.sendFile(path.resolve(__dirname, \"public\",\"index.html\"));\r\n})\r\n\r\n\r\nlet clientCount = 0;\r\n\r\nconsole.log(\"initing socket event handlers\");\r\n\r\nio.on('connection', socket => {\r\n    console.log('new connection');\r\n\r\n    socket.on('message', (message, roomId) => {\r\n        socket.to(roomId).emit('message', message);\r\n    })\r\n\r\n    socket.on('message2', (message, roomId) => {\r\n        socket.to(roomId).emit('message2', message);\r\n    })\r\n\r\n    socket.on('join-room', roomId => {\r\n        console.log('new client joined room' + roomId);\r\n\r\n        clientCount++;\r\n        if (clientCount == 1) {\r\n            console.log('creating room');\r\n\r\n            socket.join(roomId);\r\n            socket.emit('created', roomId);\r\n        } \r\n        else if (clientCount == 2) {\r\n            console.log('2nd client joined');\r\n\r\n            socket.to(roomId).emit('join', roomId);\r\n            socket.join(roomId);\r\n            socket.emit('joined', roomId);\r\n        }\r\n        else {\r\n            console.log('Rejected a client, room full');\r\n\r\n            socket.emit('full');\r\n        }\r\n    })\r\n    socket.on('disconnect', () => {\r\n        clientCount--;\r\n        console.log(`a user disconnected, user remaining: ${clientCount}`);\r\n    });\r\n})\r\n\r\n\r\n\r\n\r\nmodule.exports = server;","const app = require('./app');\r\n\r\nconst port = '8888';\r\n\r\napp.listen(port, '0.0.0.0', () => {\r\n  console.log(`Server is listening on port ${port}...`);\r\n});"]}