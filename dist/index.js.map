{"version":3,"sources":["app.js","index.js"],"names":["express","require","path","app","server","createServer","io","use","static","join","__dirname","get","req","res","sendFile","resolve","clientCount","console","log","on","socket","message","roomId","to","emit","module","exports","port","listen"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAC,MAAD,CAApB;;AAEA,MAAME,GAAG,GAAGH,OAAO,EAAnB,EAEA;;AACA,MAAMI,MAAM,GAAGH,OAAO,CAAC,MAAD,CAAP,CAAgBI,YAAhB,CAA6BF,GAA7B,CAAf;;AACA,MAAMG,EAAE,GAAGL,OAAO,CAAC,WAAD,CAAP,CAAqBG,MAArB,CAAX;;AAEAD,GAAG,CAACI,GAAJ,CAAQP,OAAO,CAACQ,MAAR,CAAeN,IAAI,CAACO,IAAL,CAAUC,SAAV,EAAqB,QAArB,CAAf,CAAR;AAEAP,GAAG,CAACQ,GAAJ,CAAQ,GAAR,EAAa,CAACC,GAAD,EAAKC,GAAL,KAAW;AACpBA,EAAAA,GAAG,CAACC,QAAJ,CAAaZ,IAAI,CAACa,OAAL,CAAaL,SAAb,EAAwB,QAAxB,EAAiC,YAAjC,CAAb;AACH,CAFD;AAKA,IAAIM,WAAW,GAAG,CAAlB;AAEAC,OAAO,CAACC,GAAR,CAAY,+BAAZ;AAEAZ,EAAE,CAACa,EAAH,CAAM,YAAN,EAAoBC,MAAM,IAAI;AAC1BH,EAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AAEAE,EAAAA,MAAM,CAACD,EAAP,CAAU,SAAV,EAAqB,CAACE,OAAD,EAAUC,MAAV,KAAqB;AACtCF,IAAAA,MAAM,CAACG,EAAP,CAAUD,MAAV,EAAkBE,IAAlB,CAAuB,SAAvB,EAAkCH,OAAlC;AACH,GAFD;AAIAD,EAAAA,MAAM,CAACD,EAAP,CAAU,WAAV,EAAuBG,MAAM,IAAI;AAC7BL,IAAAA,OAAO,CAACC,GAAR,CAAY,2BAA2BI,MAAvC;AAEAN,IAAAA,WAAW;;AACX,QAAIA,WAAW,IAAI,CAAnB,EAAsB;AAClBC,MAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AAEAE,MAAAA,MAAM,CAACX,IAAP,CAAYa,MAAZ;AACAF,MAAAA,MAAM,CAACI,IAAP,CAAY,SAAZ,EAAuBF,MAAvB;AACH,KALD,MAMK,IAAIN,WAAW,IAAI,CAAnB,EAAsB;AACvBC,MAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;AAEAE,MAAAA,MAAM,CAACG,EAAP,CAAUD,MAAV,EAAkBE,IAAlB,CAAuB,MAAvB,EAA+BF,MAA/B;AACAF,MAAAA,MAAM,CAACX,IAAP,CAAYa,MAAZ;AACAF,MAAAA,MAAM,CAACI,IAAP,CAAY,QAAZ,EAAsBF,MAAtB;AACH,KANI,MAOA;AACDL,MAAAA,OAAO,CAACC,GAAR,CAAY,8BAAZ;AAEAE,MAAAA,MAAM,CAACI,IAAP,CAAY,MAAZ;AACH;AACJ,GAtBD;AAuBAJ,EAAAA,MAAM,CAACD,EAAP,CAAU,YAAV,EAAwB,MAAM;AAC1BH,IAAAA,WAAW;AACXC,IAAAA,OAAO,CAACC,GAAR,CAAa,wCAAuCF,WAAY,EAAhE;AACH,GAHD;AAIH,CAlCD,GAuCA;;AACAS,MAAM,CAACC,OAAP,GAAiBtB,MAAjB;;AC5DA,MAAMD,GAAG,GAAGF,OAAO,CAAC,OAAD,CAAnB;;AAEA,MAAM0B,IAAI,GAAG,MAAb;AAEAxB,GAAG,CAACyB,MAAJ,CAAWD,IAAX,EAAiB,MAAM;AACrBV,EAAAA,OAAO,CAACC,GAAR,CAAa,+BAA8BS,IAAK,KAAhD;AACD,CAFD","file":"index.js","sourceRoot":"../src","sourcesContent":["const express = require('express');\r\nconst path = require('path');\r\n\r\nconst app = express();\r\n\r\n//added by me\r\nconst server = require('http').createServer(app);\r\nconst io = require('socket.io')(server);\r\n\r\napp.use(express.static(path.join(__dirname, 'public')));\r\n\r\napp.get('/', (req,res)=>{\r\n    res.sendFile(path.resolve(__dirname, \"public\",\"index.html\"));\r\n})\r\n\r\n\r\nlet clientCount = 0;\r\n\r\nconsole.log(\"initing socket event handlers\");\r\n\r\nio.on('connection', socket => {\r\n    console.log('new connection');\r\n\r\n    socket.on('message', (message, roomId) => {\r\n        socket.to(roomId).emit('message', message);\r\n    })\r\n\r\n    socket.on('join-room', roomId => {\r\n        console.log('new client joined room' + roomId);\r\n\r\n        clientCount++;\r\n        if (clientCount == 1) {\r\n            console.log('creating room');\r\n\r\n            socket.join(roomId);\r\n            socket.emit('created', roomId);\r\n        } \r\n        else if (clientCount == 2) {\r\n            console.log('2nd client joined');\r\n\r\n            socket.to(roomId).emit('join', roomId);\r\n            socket.join(roomId);\r\n            socket.emit('joined', roomId);\r\n        }\r\n        else {\r\n            console.log('Rejected a client, room full');\r\n\r\n            socket.emit('full');\r\n        }\r\n    })\r\n    socket.on('disconnect', () => {\r\n        clientCount--;\r\n        console.log(`a user disconnected, user remaining: ${clientCount}`);\r\n    });\r\n})\r\n\r\n\r\n\r\n\r\n//module.exports = app;\r\nmodule.exports = server;","const app = require('./app');\r\n\r\nconst port = '8888';\r\n\r\napp.listen(port, () => {\r\n  console.log(`Server is listening on port ${port}...`);\r\n});"]}